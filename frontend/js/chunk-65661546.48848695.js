(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-65661546"],{"7c99":function(e,t,a){},cb6a:function(e,t,a){"use strict";a("7c99")},cc43:function(e,t,a){"use strict";a("fcaf")},d250:function(e,t,a){"use strict";a("f27b")},f220:function(e,t,a){"use strict";a("14d9");var l=a("7a23"),o=a("415f"),c=a("c57c"),n=a("44a6");const r={class:"search-class-ul"},s={key:0,class:"time-choose-box"},i={key:1,class:"select-box"},d={key:2,class:"el-select-tree-box"},p={key:3,class:"el-select-tree-box"},u={key:4,class:"demo-date-picker",style:{margin:"10px"}},m={class:"block"},b={key:1,class:"opera-buttons"},h={class:""},f={style:{position:"absolute",top:"-20%",left:"0",visibility:"hidden"}};var O=Object(l["defineComponent"])({__name:"SearchClass",props:{searchInit:{type:Object,default:()=>[]},searchInfo:{type:Object,default:()=>({})},tableName:{type:Object,default:()=>({})},refresh:{type:Boolean,default:!1},isHideRight:{type:Boolean,default:!1},isShowReset:{type:Boolean,default:!1},searchKey:{type:String,default:"name"},isShowSearchInput:{type:Boolean,default:!0},list:{type:Array,default:()=>[]},tableColumns:{type:Array,default:()=>[]},placeholder:{type:String,default:"搜索"},isShowExportBtn:{type:Boolean,default:!1}},emits:["exportAll","update:refresh","update:tableColumns","update:searchInfo","search"],setup(e,{emit:t}){const a=Object(l["ref"])(!1),O=e,j=Object(l["ref"])(null),y=t,k=()=>{w.searchInfo={},y("update:searchInfo",{}),y("search",{}),y("update:refresh",!0)},g=(e,t)=>{if(e&&t.url){a.value=!0;const l={};t.isInWhereName&&e?t.queryParams.where.name={_like:e}:l[t.searchKey||"name"]=e,n["a"][t.httpType||"get"](t.url,{...t.queryParams,...l}||{}).then(e=>{a.value=!1,t.options=e.list})}else t.options=[]},V=(e,t)=>({disabledDate(t){if(e="today"===e?n["a"].formatTime(""):e,e&&e);else if(e)return new Date(e).getTime()>t.getTime()}}),v=()=>{y("exportAll")},C=Object(l["reactive"])({checkStrictly:!0,label:"name",value:"id"}),w=Object(l["reactive"])({inputSearch:"",cascadeChecked:(()=>{const e=[];return O.tableColumns.forEach(t=>{t.isHide||e.push([t.valueKey])}),e})(),pickerOptions:{shortcuts:[{text:"最近一周",onClick:e=>{const t=new Date,a=new Date;a.setTime(a.getTime()-6048e5),e.$emit("pick",[a,t])}},{text:"最近一个月",onClick:e=>{const t=new Date,a=new Date;a.setTime(a.getTime()-2592e6),e.$emit("pick",[a,t])}},{text:"最近三个月",onClick:e=>{const t=new Date,a=new Date;a.setTime(a.getTime()-7776e6),e.$emit("pick",[a,t])}}]},searchInfo:{},categoryName:"",Refresh:o["a"]}),N=(e,t)=>{const a=JSON.parse(JSON.stringify(w.searchInfo));a[O.searchKey]?a[O.searchKey]="%"+a[O.searchKey].trim()+"%":delete a[O.searchKey],y("update:searchInfo",a),y("search",a),y("update:refresh",!0)},I=e=>{e.url&&g("%%",e)},x=()=>{y("update:refresh",!0)},B=(e,t)=>{w.categoryName=e.name,w.searchInfo[t.value]=e.name,y("search",{[t.value]:e.id}),y("update:refresh",!0)},E=e=>{const t=[],a=new Map(JSON.parse(JSON.stringify(w.cascadeChecked)));O.tableColumns.forEach(e=>{e.isHide=!a.has(e.valueKey),t.push(e)}),y("update:tableColumns",t)},S=()=>{console.log("==>>??",j.value),j.value.popperVisible=!0};return Object(l["onMounted"])(()=>{(O.searchInit||[]).forEach(e=>{e.defaultValue&&(w.searchInfo[e.value]=e.defaultValue)})}),(t,n)=>{const O=Object(l["resolveComponent"])("el-date-picker"),y=Object(l["resolveComponent"])("el-option"),D=Object(l["resolveComponent"])("el-select"),P=Object(l["resolveComponent"])("el-tree"),T=Object(l["resolveComponent"])("el-cascader"),_=Object(l["resolveComponent"])("el-button"),U=Object(l["resolveComponent"])("el-input"),K=Object(l["resolveComponent"])("el-button-group");return Object(l["openBlock"])(),Object(l["createElementBlock"])("div",r,[(Object(l["openBlock"])(!0),Object(l["createElementBlock"])(l["Fragment"],null,Object(l["renderList"])(e.searchInit,(e,o)=>(Object(l["openBlock"])(),Object(l["createElementBlock"])("div",{key:o,class:"class-box"},["isTime"===e["name"]?(Object(l["openBlock"])(),Object(l["createElementBlock"])("div",s,[Object(l["createElementVNode"])("span",null,Object(l["toDisplayString"])(e["desc"])+"：",1),e["daterange"]?(Object(l["openBlock"])(),Object(l["createBlock"])(O,{key:1,modelValue:w.searchInfo[e["value"]],"onUpdate:modelValue":t=>w.searchInfo[e["value"]]=t,"picker-options":t.pickerOptions,align:"right","end-placeholder":"结束日期","range-separator":"至",size:"small","start-placeholder":"开始日期",type:"derange","unlink-panels":""},null,8,["modelValue","onUpdate:modelValue","picker-options"])):(Object(l["openBlock"])(),Object(l["createBlock"])(O,{key:0,modelValue:w.searchInfo[e["value"]],"onUpdate:modelValue":t=>w.searchInfo[e["value"]]=t,placeholder:e["placeholder"],size:"small",type:"date"},null,8,["modelValue","onUpdate:modelValue","placeholder"]))])):"isSelect"===e["name"]?(Object(l["openBlock"])(),Object(l["createElementBlock"])("div",i,[Object(l["createElementVNode"])("span",null,Object(l["toDisplayString"])(e["desc"])+"：",1),Object(l["createVNode"])(D,{modelValue:w.searchInfo[e["value"]],"onUpdate:modelValue":t=>w.searchInfo[e["value"]]=t,loading:a.value,placeholder:e["placeholder"],"remote-method":t=>{g(t,e)},filterable:"",remote:"",clearable:!e["isNotClearable"],size:"small",onChange:N,onFocus:t=>I(e)},{default:Object(l["withCtx"])(()=>[(Object(l["openBlock"])(!0),Object(l["createElementBlock"])(l["Fragment"],null,Object(l["renderList"])(e["options"],t=>(Object(l["openBlock"])(),Object(l["createBlock"])(y,{key:t.id,label:t[e["labelKey"]]||t.name,value:t[e["valueKey"]]||t.id},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","loading","placeholder","remote-method","clearable","onFocus"])])):"isSelectTree"===e["name"]?(Object(l["openBlock"])(),Object(l["createElementBlock"])("div",d,[Object(l["createElementVNode"])("span",null,Object(l["toDisplayString"])(e["desc"])+"：",1),Object(l["createVNode"])(D,{modelValue:w.searchInfo[e["value"]],"onUpdate:modelValue":t=>w.searchInfo[e["value"]]=t,placeholder:e["placeholder"]},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(y,{label:t.categoryName,value:e["categoryId"],style:{height:"auto",padding:"0"}},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(P,{ref_for:!0,ref:"tree",data:e.options,"node-key":e.id,props:e["formatProps"],"highlight-current":"",onNodeClick:t=>B(t,e)},null,8,["data","node-key","props","onNodeClick"])]),_:2},1032,["label","value"])]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder"])])):"isCascader"===e["name"]?(Object(l["openBlock"])(),Object(l["createElementBlock"])("div",p,[Object(l["createElementVNode"])("span",null,Object(l["toDisplayString"])(e["desc"])+"：",1),Object(l["createVNode"])(T,{modelValue:w.searchInfo[e["value"]],"onUpdate:modelValue":t=>w.searchInfo[e["value"]]=t,disabled:e.disabled,options:e.list,placeholder:e.placeholder,props:e.props||C,"show-all-levels":!1,clearable:"",onChange:t=>{N(t,e)}},null,8,["modelValue","onUpdate:modelValue","disabled","options","placeholder","props","onChange"])])):"daterange"===e["name"]?(Object(l["openBlock"])(),Object(l["createElementBlock"])("div",u,[Object(l["createElementVNode"])("div",m,[n[2]||(n[2]=Object(l["createElementVNode"])("span",{class:"demonstration"},"选择周期：",-1)),Object(l["createVNode"])(O,{modelValue:w.searchInfo[e["value"]],"onUpdate:modelValue":t=>w.searchInfo[e["value"]]=t,type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",size:"small","unlink-panels":"","picker-options":V(e.maxDate),onChange:t=>{N(t,e)}},null,8,["modelValue","onUpdate:modelValue","picker-options","onChange"])])])):Object(l["createCommentVNode"])("",!0)]))),128)),e.isShowReset?(Object(l["openBlock"])(),Object(l["createBlock"])(_,{key:0,size:"small",type:"primary",plain:"",onClick:k},{default:Object(l["withCtx"])(()=>n[3]||(n[3]=[Object(l["createTextVNode"])("重置")])),_:1})):Object(l["createCommentVNode"])("",!0),e.isHideRight?Object(l["createCommentVNode"])("",!0):(Object(l["openBlock"])(),Object(l["createElementBlock"])("div",b,[Object(l["createElementVNode"])("div",h,[Object(l["renderSlot"])(t.$slots,"left-btn")]),Object(l["createElementVNode"])("div",null,[e.isShowSearchInput?(Object(l["openBlock"])(),Object(l["createBlock"])(U,{key:0,modelValue:w.searchInfo[e.searchKey],"onUpdate:modelValue":n[0]||(n[0]=t=>w.searchInfo[e.searchKey]=t),placeholder:e.placeholder,size:"small",style:{width:"200px","margin-right":"16px"},onInput:N,clearable:""},null,8,["modelValue","placeholder"])):Object(l["createCommentVNode"])("",!0),Object(l["createVNode"])(K,{class:"ml-4",size:"small"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(_,{icon:Object(l["unref"])(o["a"]),onClick:x},null,8,["icon"]),Object(l["createVNode"])(_,{icon:Object(l["unref"])(c["a"]),onClick:S,style:{position:"relative"}},{default:Object(l["withCtx"])(()=>[Object(l["createElementVNode"])("div",f,[Object(l["createVNode"])(T,{"popper-class":"table-column-list-choose",modelValue:w.cascadeChecked,"onUpdate:modelValue":n[1]||(n[1]=e=>w.cascadeChecked=e),ref_key:"cascadeRef",ref:j,options:e.tableColumns,props:{value:"valueKey",multiple:!0},"collapse-tags":"",onChange:E},null,8,["modelValue","options"])])]),_:1},8,["icon"]),e.isShowExportBtn?(Object(l["openBlock"])(),Object(l["createBlock"])(_,{key:0,onClick:v},{default:Object(l["withCtx"])(()=>n[4]||(n[4]=[Object(l["createTextVNode"])(" 导出全部 ")])),_:1})):Object(l["createCommentVNode"])("",!0),Object(l["renderSlot"])(t.$slots,"right-group-btn")]),_:3})])]))])}}}),j=(a("cc43"),a("d250"),a("6b0d")),y=a.n(j);const k=y()(O,[["__scopeId","data-v-bef45afa"]]);t["a"]=k},f27b:function(e,t,a){},fcaf:function(e,t,a){},fee7:function(e,t,a){"use strict";a.r(t);var l=a("7a23");const o={class:"column-setting"},c={class:"custom-tree-node"};function n(e,t,a,n,r,s){const i=Object(l["resolveComponent"])("el-button"),d=Object(l["resolveComponent"])("search-class"),p=Object(l["resolveComponent"])("el-tree"),u=Object(l["resolveComponent"])("form-list"),m=Object(l["resolveComponent"])("el-dialog");return Object(l["openBlock"])(),Object(l["createElementBlock"])("div",o,[Object(l["createVNode"])(d,{refresh:e.pageParams.refresh,"onUpdate:refresh":t[1]||(t[1]=t=>e.pageParams.refresh=t),searchInit:e.searchInit,onSearch:e.search,"is-show-export-btn":!0,onExportAll:e.exportAll},{"left-btn":Object(l["withCtx"])(()=>[Object(l["createVNode"])(i,{class:"background-btn",plain:"",size:"small",type:"primary",onClick:t[0]||(t[0]=t=>e.$tools.openDrawer(e.pageParams))},{default:Object(l["withCtx"])(()=>t[3]||(t[3]=[Object(l["createTextVNode"])("添加栏目 ")])),_:1})]),_:1},8,["refresh","searchInit","onSearch","onExportAll"]),Object(l["createVNode"])(p,{data:e.list,"expand-on-click-node":!1,props:{children:"children",label:"name"},"default-expand-all":"","node-key":"id","show-checkbox":""},{default:Object(l["withCtx"])(({node:a,data:o})=>[Object(l["createElementVNode"])("span",c,[Object(l["createElementVNode"])("span",null,Object(l["toDisplayString"])(a.label),1),Object(l["createElementVNode"])("span",null,[Object(l["createVNode"])(i,{size:"small",type:"text",onClick:t=>e.openDrawer(o)},{default:Object(l["withCtx"])(()=>t[4]||(t[4]=[Object(l["createTextVNode"])("查看/修改")])),_:2},1032,["onClick"]),(Object(l["openBlock"])(),Object(l["createBlock"])(i,{key:0,class:"font-red",size:"small",type:"text",onClick:t=>e.$tools.deleteById("homeColumns",o.id,e.pageParams)},{default:Object(l["withCtx"])(()=>t[5]||(t[5]=[Object(l["createTextVNode"])("删除节点")])),_:2},1032,["onClick"]))])])]),_:1},8,["data"]),Object(l["createVNode"])(m,{modelValue:e.pageParams.isDrawer,"onUpdate:modelValue":t[2]||(t[2]=t=>e.pageParams.isDrawer=t),"destroy-on-close":"",title:"栏目设置",width:"40%"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(u,{isEdit:e.pageParams.isEdit,list:e.formList,onSubmit:e.submit},null,8,["isEdit","list","onSubmit"])]),_:1},8,["modelValue"])])}a("14d9");var r=a("f220"),s=a("44a6"),i=a("1f4d"),d=Object(l["defineComponent"])({name:"",components:{FormList:i["a"],SearchClass:r["a"]},setup:()=>{const e=Object(l["reactive"])({list:[],pageParams:{isEdit:!1,isDrawer:!1,refresh:!1},isMenuTypeSetDialog:!1,currentColumnId:null,searchInfo:{},selection:[],isSetMenu:!0,searchInit:[],queryParam:{sort:"sequence asc",limit:1e3,name:""},formList:[{type:"none",key:"id",value:null},{type:"input",label:"栏目名称",key:"name",width:"",value:null,required:!0,defaultValue:null},{type:"cascade",label:"父级栏目",key:"parentId",width:"",value:null,url:"/homeColumns/getListByPage",queryParams:{limit:1e4,sort:"sequence asc"},defaultValue:""},{type:"input",label:"栏目code",key:"code",width:"",value:null,required:!0,defaultValue:null},{type:"number",label:"排序级别",key:"sequence",width:"",value:"",defaultValue:null},{type:"switch",label:"做为副标题",key:"isSubTitle",activeValue:!0,inactiveValue:!1,value:!1,defaultValue:!1},{type:"switch",label:"状态",key:"status",width:"",value:"",defaultValue:null}]}),t=()=>{s["a"].get("/homeColumns/getListByPage",{...e.queryParam}).then(t=>{e.list=t.list})},a=async t=>{const a=JSON.parse(JSON.stringify(t));a.parentId=a.parentId?"string"===typeof a.parentId?a.parentId:a.parentId[a.parentId.length-1]:null;const l=s["a"].showLoading("提交中...");e.pageParams.isEdit?s["a"].post("/homeColumns/updateById",a).then(t=>{s["a"].closeLoading(l),t.success&&(e.pageParams.isDrawer=!1,s["a"].msg(t.msg),e.pageParams.refresh=!0)}):(delete a.id,s["a"].post("/homeColumns/create",a).then(t=>{s["a"].closeLoading(l),t.success&&(s["a"].msg(t.msg),e.pageParams.isDrawer=!1,e.pageParams.refresh=!0)}))},o=t=>{console.log(t),e.queryParam.name=t.name},c=(e=[],t=[],a,l={})=>{t.forEach(t=>{const o={};for(const e in a)o[e]=t[a[""+e]];t.parentId&&(o["父级"]=l.name,o["父级编码"]=l.code),e.push(o),t.children&&t.children.length>0&&c(e,t.children,a,t)})},n=()=>{const t={"名称":"name","编码":"code"},a=[];c(a,e.list,t),s["a"].exportExcel(a,"栏目类型")},r=t=>{e.pageParams.isDrawer=!0,e.pageParams.isEdit=!0,e.formList.forEach(e=>{e.value=t[e.key]})},i=t=>{e.isMenuTypeSetDialog=!0,e.currentColumnId=t.id,Object(l["nextTick"])(()=>{const e=document.querySelector(".main-content>.el-overlay");e.style.position="absolute",e.style.height="100%"})};return Object(l["onMounted"])(()=>{t()}),Object(l["watch"])(()=>e.pageParams.refresh,async a=>{a&&(await t(),e.pageParams.refresh=!1)}),{...Object(l["toRefs"])(e),exportAll:n,openMenuTypeSet:i,openDrawer:r,getDataList:t,submit:a,search:o}}}),p=(a("cb6a"),a("6b0d")),u=a.n(p);const m=u()(d,[["render",n]]);t["default"]=m}}]);