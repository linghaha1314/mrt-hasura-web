(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2b2e2a2b"],{"12db":function(e,t,a){"use strict";a.r(t);var l=a("7a23");const o={class:"users-manage"},r={key:0,class:"font-warning font-bold"},s={key:1,class:"font-red font-bold"},c={key:2,class:"font-red font-bold"},n={key:3,class:"font-warning font-bold"},i={key:4,class:"font-green font-bold"};function d(e,t,a,d,p,u){const b=Object(l["resolveComponent"])("el-button"),m=Object(l["resolveComponent"])("search-class"),y=Object(l["resolveComponent"])("Preview"),h=Object(l["resolveComponent"])("Approval"),O=Object(l["resolveComponent"])("table-list"),f=Object(l["resolveComponent"])("form-list"),j=Object(l["resolveComponent"])("el-drawer");return Object(l["openBlock"])(),Object(l["createElementBlock"])("div",o,[Object(l["createVNode"])(m,{searchInit:e.searchInit,refresh:e.pageParams.refresh,"onUpdate:refresh":t[2]||(t[2]=t=>e.pageParams.refresh=t),onSearch:e.search},{"left-btn":Object(l["withCtx"])(()=>[Object(l["withDirectives"])(Object(l["createVNode"])(b,{onClick:t[0]||(t[0]=t=>e.setFn()),class:"background-btn",size:"small",type:"primary",plain:""},{default:Object(l["withCtx"])(()=>t[8]||(t[8]=[Object(l["createTextVNode"])("新增老师 ")])),_:1},512),[[l["vShow"],"add"===e.authorization]]),Object(l["createVNode"])(b,{type:"danger",plain:"",size:"small",onClick:t[1]||(t[1]=t=>e.tools.delMultiple("teacher_style",e.selection,e.pageParams))},{default:Object(l["withCtx"])(()=>t[9]||(t[9]=[Object(l["createTextVNode"])("删除 ")])),_:1})]),_:1},8,["searchInit","refresh","onSearch"]),Object(l["createVNode"])(O,{selection:e.selection,"onUpdate:selection":t[4]||(t[4]=t=>e.selection=t),columns:e.tableColumns,url:"/teacher_style/getListByPage","query-data":e.searchInfo,refresh:e.pageParams.refresh,"onUpdate:refresh":t[5]||(t[5]=t=>e.pageParams.refresh=t)},{status:Object(l["withCtx"])(e=>[-1===e.row.status?(Object(l["openBlock"])(),Object(l["createElementBlock"])("span",r,"未提交")):Object(l["createCommentVNode"])("",!0),0===e.row.status?(Object(l["openBlock"])(),Object(l["createElementBlock"])("span",s,"审核驳回")):Object(l["createCommentVNode"])("",!0),2===e.row.status?(Object(l["openBlock"])(),Object(l["createElementBlock"])("span",c,"禁用")):Object(l["createCommentVNode"])("",!0),11===e.row.status?(Object(l["openBlock"])(),Object(l["createElementBlock"])("span",n,"待审核")):Object(l["createCommentVNode"])("",!0),1===e.row.status?(Object(l["openBlock"])(),Object(l["createElementBlock"])("span",i,"启用")):Object(l["createCommentVNode"])("",!0)]),default:Object(l["withCtx"])(a=>[Object(l["withDirectives"])(Object(l["createVNode"])(b,{type:"primary",size:"small",onClick:t=>e.setFn(a)},{default:Object(l["withCtx"])(()=>t[10]||(t[10]=[Object(l["createTextVNode"])("查看/修改 ")])),_:2},1032,["onClick"]),[[l["vShow"],"add"===e.authorization]]),Object(l["createVNode"])(y,{"ok-data":a["row"],"is-teacher":""},null,8,["ok-data"]),Object(l["createVNode"])(b,{type:"danger",size:"small",style:{"margin-left":"10px"},onClick:t=>e.tools.deleteById("teacher_style",a["row"].id,e.pageParams)},{default:Object(l["withCtx"])(()=>t[11]||(t[11]=[Object(l["createTextVNode"])("删除 ")])),_:2},1032,["onClick"]),Object(l["createVNode"])(h,{data:a,refresh:e.pageParams.refresh,"onUpdate:refresh":t[3]||(t[3]=t=>e.pageParams.refresh=t),"table-name":"teacher_style","type-code":"teacher_style",onApproval:e.approvalFn},null,8,["data","refresh","onApproval"])]),_:1},8,["selection","columns","query-data","refresh"]),e.apply?(Object(l["openBlock"])(),Object(l["createBlock"])(j,{key:0,title:"详细信息",modelValue:e.pageParams.isDrawer,"onUpdate:modelValue":t[6]||(t[6]=t=>e.pageParams.isDrawer=t),direction:"rtl","append-to-body":!1,"destroy-on-close":!0,size:"40%"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(f,{list:e.formList,isEdit:e.pageParams.isEdit,onSubmit:e.submit},null,8,["list","isEdit","onSubmit"])]),_:1},8,["modelValue"])):(Object(l["openBlock"])(),Object(l["createBlock"])(j,{key:1,title:"详细信息",modelValue:e.pageParams.isDrawer,"onUpdate:modelValue":t[7]||(t[7]=t=>e.pageParams.isDrawer=t),direction:"rtl","append-to-body":!1,"destroy-on-close":!0,size:"40%"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(f,{list:e.applyParam,isEdit:e.pageParams.isEdit,onSubmit:e.submit},null,8,["list","isEdit","onSubmit"])]),_:1},8,["modelValue"]))])}var p=a("f220"),u=a("44a6"),b=a("d6de"),m=a("1f4d"),y=a("b02f"),h=a("f10b"),O=a("afbc"),f=a("6605"),j=Object(l["defineComponent"])({name:"",components:{FormList:m["a"],SearchClass:p["a"],TableList:b["a"],Preview:y["a"],Approval:h["a"]},setup:()=>{const e=Object(l["reactive"])({authorization:"",pageParams:{isEdit:!1,isDrawer:!1,refresh:!1},searchInfo:{status:null,name:null},selection:[],tableColumns:[{valueKey:"selection",label:"",type:"selection"},{valueKey:"name",label:"医生姓名"},{valueKey:"title",label:"职位"},{valueKey:"typeId",label:"栏目类型",list:[]},{valueKey:"hospital",label:"医院"},{valueKey:"status",width:120,label:"状态",type:"slot"},{valueKey:"created",label:"创建日期",type:"time"}],searchInit:[{name:"isSelect",desc:"状态",placeholder:"选择状态",value:"status",valueKey:"status",defaultValue:null,options:[{status:null,name:"不限制"},{status:"-1",name:"未提交"},{status:"11",name:"待审核"},{status:"0",name:"驳回"},{status:"1",name:"启用"},{status:"2",name:"禁用"}]}],apply:!1,applyParam:[{label:"索引",key:"id",value:null,defaultValue:null},{type:"input",label:"老师姓名",key:"name",width:"",value:null,required:!0,defaultValue:null},{type:"input",label:"职位",key:"title",width:"",value:null,required:!0,defaultValue:null},{type:"input",label:"医院名字",key:"hospital",width:"",value:null,required:!0,defaultValue:null},{type:"cascade",label:"科室",key:"sectionId",width:"",value:null,url:"/section/getListByPage",list:[],queryParams:{limit:999},props:{checkStrictly:!0,label:"name",value:"id"},typeList:[],defaultValue:""},{type:"textarea",label:"老师简介",key:"content",width:"",value:null,required:!0,defaultValue:null},{type:"input",label:"顺序",placeholder:"请输入顺序",key:"sequence",width:"",value:"",required:!0,defaultValue:null},{type:"richText",label:"经典事迹",placeholder:"请编辑内容",key:"detail",url:"http://localhost:3001/public/upload",width:"",value:"",required:!0,defaultValue:""},{type:"uploadImg",label:"个人照片",placeholder:"请上传",key:"photo",width:"",value:"",required:!0,defaultValue:""},{type:"select",label:"栏目类型",key:"typeId",width:"",value:null,url:"/ps_menus/getDataByIdMore",queryParams:{parentId:"7236f649-bc27-4ce5-82e0-9dbdc388c357"},httpType:"post",defaultValue:"",required:!0},{type:"radio",label:"审核",placeholder:"请输入图标code",key:"status",width:"",value:"",defaultValue:1,required:!0,options:[{name:"同意",value:1},{name:"不同意",value:0}]}],formList:[{label:"索引",key:"id",value:null,defaultValue:null},{type:"input",label:"老师姓名",key:"name",width:"",value:null,required:!0,defaultValue:null},{type:"input",label:"职位",key:"title",width:"",value:null,required:!0,defaultValue:null},{type:"input",label:"医院名字",key:"hospital",width:"",value:null,required:!0,defaultValue:null},{type:"select",label:"科室",key:"sectionId",width:"",value:null,url:"/section/getListByPage",list:[],queryParams:{limit:999},props:{checkStrictly:!0,label:"name",value:"id"},typeList:[],defaultValue:""},{type:"textarea",label:"老师简介",key:"content",width:"",value:null,required:!0,defaultValue:null},{type:"input",label:"顺序",placeholder:"请输入顺序",key:"sequence",width:"",value:"",required:!0,defaultValue:null},{type:"richText",label:"经典事迹",placeholder:"请编辑内容",key:"detail",url:"http://localhost:3001/public/upload",width:"",value:"",required:!0,defaultValue:""},{type:"uploadImg",label:"个人照片",placeholder:"请上传",key:"photo",width:"",value:"",required:!0,defaultValue:""},{type:"select",label:"栏目类型",key:"typeId",width:"",value:null,url:"/ps_menus/getDataByIdMore",queryParams:{parentId:"7236f649-bc27-4ce5-82e0-9dbdc388c357"},httpType:"post",defaultValue:"",required:!0}],roles:["superadmin","ColumnAdministrator","PlatformAdministrator"]}),t=Object(l["ref"])({searchInfo:{},searchInit:[{name:"isSelect",desc:"专业",value:"searchProfession",placeholder:"请选择选择专业",options:[]},{name:"isSelect",desc:"科室",value:"searchDepartment",placeholder:"请选择选择科室",options:[]}],leftBtn:[{name:"添加",fn:()=>{console.log(111111)}},{name:"删除",type:"danger"}]});Object(l["watch"])(()=>O["a"].currentRoute.value.query,t=>{e.authorization=t.code});const a=async t=>{const a=await u["a"].post("/ps_menus/getDataByIdMore",{parentId:"7236f649-bc27-4ce5-82e0-9dbdc388c357"});e.tableColumns[t].list=a.data};a(3);const o=e=>{u["a"].post("/teacher_style/resetPass",{id:e.data.id}).then(e=>{e.success&&u["a"].msg(e.msg)})},r=t=>{const a=JSON.parse(JSON.stringify(t)),l={name:a.name,content:a.content,code:a.code||"",status:a.status||-1,detail:a.detail,title:a.title,hospital:a.hospital,photo:a.photo,typeId:a.typeId,sectionId:a.sectionId,sequence:a.sequence};if(e.pageParams.isEdit)return l.id=a.id,void u["a"].post("/teacher_style/updateById",l).then(t=>{t.success&&(e.pageParams.isDrawer=!1,u["a"].msg(t.msg),e.pageParams.refresh=!0)});u["a"].post("/teacher_style/create",l).then(t=>{t.success&&(u["a"].msg(t.msg),e.pageParams.isDrawer=!1,e.pageParams.refresh=!0)})},s=t=>{e.searchInfo.status=t.status,t.name&&(e.searchInfo.name=t.name.indexOf("undefined")>-1||2===t.name.length?null:t.name.substring(1,t.name.length-1))},c=t=>{e.apply=!1,u["a"].openDrawer(e.pageParams,!0,e.applyParam,t.row)},n=t=>{e.apply=!0,t?u["a"].openDrawer(e.pageParams,!0,e.formList,t.row):u["a"].openDrawer(e.pageParams)},i=()=>{e.pageParams.refresh=!0};return Object(l["onBeforeMount"])(()=>{const t=Object(f["c"])(),a=t.query;e.authorization=a.code||""}),{searchData:t,...Object(l["toRefs"])(e),resetPass:o,submit:r,search:s,applyFn:c,setFn:n,approvalFn:i,tools:u["a"]}}}),v=a("6b0d"),k=a.n(v);const g=k()(j,[["render",d]]);t["default"]=g},f10b:function(e,t,a){"use strict";var l=a("7a23");const o={style:{display:"inline","margin-left":"10px"}},r={class:"flex align-center"},s={style:{"margin-top":"8px"}},c={style:{color:"#666666","margin-bottom":"8px"}},n={key:0,class:"font-orange font-bold"},i={key:1,class:"font-green font-bold"},d={key:2,class:"font-red font-bold"},p={class:"padding-start"},u={key:0,style:{color:"#666666","margin-bottom":"8px"}},b={key:0,style:{margin:"16px 0"}};function m(e,t,a,m,y,h){const O=Object(l["resolveComponent"])("strip-title"),f=Object(l["resolveComponent"])("el-timeline-item"),j=Object(l["resolveComponent"])("el-timeline"),v=Object(l["resolveComponent"])("el-button"),k=Object(l["resolveComponent"])("el-dialog");return Object(l["openBlock"])(),Object(l["createElementBlock"])("div",o,[Object(l["createVNode"])(k,{modelValue:e.isApprovalDialog,"onUpdate:modelValue":t[1]||(t[1]=t=>e.isApprovalDialog=t),"destroy-on-close":""},{title:Object(l["withCtx"])(()=>[Object(l["createElementVNode"])("div",r,[Object(l["createVNode"])(O,null,{default:Object(l["withCtx"])(()=>t[4]||(t[4]=[Object(l["createTextVNode"])("审批进度查看")])),_:1}),t[5]||(t[5]=Object(l["createTextVNode"])("   "))])]),default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(j,null,{default:Object(l["withCtx"])(()=>[(Object(l["openBlock"])(!0),Object(l["createElementBlock"])(l["Fragment"],null,Object(l["renderList"])(e.approvalList,e=>(Object(l["openBlock"])(),Object(l["createBlock"])(f,{key:e.id,placement:"bottom",size:"large",type:"primary"},{default:Object(l["withCtx"])(()=>[Object(l["createTextVNode"])(Object(l["toDisplayString"])(e["roleName"])+" ",1),Object(l["createElementVNode"])("div",s,[Object(l["createElementVNode"])("p",c,[11===e.status?(Object(l["openBlock"])(),Object(l["createElementBlock"])("span",n,"待审核")):Object(l["createCommentVNode"])("",!0),1===e.status?(Object(l["openBlock"])(),Object(l["createElementBlock"])("span",i,"通过✅")):Object(l["createCommentVNode"])("",!0),0===e.status?(Object(l["openBlock"])(),Object(l["createElementBlock"])("span",d,"驳回❌")):Object(l["createCommentVNode"])("",!0),Object(l["createElementVNode"])("small",p,Object(l["toDisplayString"])(e["approvalDate"]),1)]),e.remark?(Object(l["openBlock"])(),Object(l["createElementBlock"])("p",u,"审批意见："+Object(l["toDisplayString"])(e.remark),1)):Object(l["createCommentVNode"])("",!0)])]),_:2},1024))),128))]),_:1}),0===a.data.row.status?(Object(l["openBlock"])(),Object(l["createElementBlock"])("div",b,[Object(l["createVNode"])(v,{onClick:t[0]||(t[0]=t=>e.submitApproval(a.data.row)),type:"warning"},{default:Object(l["withCtx"])(()=>t[6]||(t[6]=[Object(l["createTextVNode"])("重新提交审核")])),_:1})])):Object(l["createCommentVNode"])("",!0)]),_:1},8,["modelValue"]),-1===a.data.row.status?(Object(l["openBlock"])(),Object(l["createBlock"])(v,{key:0,size:"small",type:"danger",onClick:t[2]||(t[2]=t=>e.submitApproval(a.data.row))},{default:Object(l["withCtx"])(()=>t[7]||(t[7]=[Object(l["createTextVNode"])(" 提交审批 ")])),_:1})):Object(l["createCommentVNode"])("",!0),11===a.data.row.status||0===a.data.row.status?(Object(l["openBlock"])(),Object(l["createBlock"])(v,{key:1,size:"small",type:"success",onClick:t[3]||(t[3]=t=>e.checkApprovalProcess(a.data.row))},{default:Object(l["withCtx"])(()=>t[8]||(t[8]=[Object(l["createTextVNode"])(" 审批进度 ")])),_:1})):Object(l["createCommentVNode"])("",!0)])}var y=a("44a6"),h=a("0613"),O={name:"approval",props:{data:{type:Object},param:{type:Object},typeCode:{type:String},tableName:{type:String}},setup:(e,{emit:t})=>{const a=Object(l["reactive"])({approvalProcessId:null,isApprovalDialog:!1,approvalList:[]}),o=async()=>{await y["a"].post("/api/rest/getApprovalProcessIdByTypeCode",{assignedRoleId:h["a"].state.manageUserInfo.currentRole.roleId,typeCode:e.typeCode}).then(e=>{const t=(e.data.listByAssignedRoleId.length>0?e.data.listByAssignedRoleId:e.data.listByTypeCode)||[];a.approvalProcessId=t.length>0?t[0].id:null}).catch(()=>{y["a"].msgError("您无权此操作！")})},r=l=>{null===a.approvalProcessId&&o(),y["a"].confirm("温馨提示","确定提交审批？").then(o=>{if(!o)return;const r=y["a"].showLoading("提交中...");l.staffId=h["a"].state.manageUserInfo.id,l.approvalProcessId=a.approvalProcessId,y["a"].post("/workflow/createProcess",{staffId:h["a"].state.manageUserInfo.id,objectId:l.id,approvalProcessId:a.approvalProcessId,tableName:e.tableName}).then(e=>{e.success&&(y["a"].msg(e.msg),t("approval",l)),y["a"].closeLoading(r)}).catch(()=>{y["a"].msgError("您无权此操作！")})})},s=e=>{null===a.approvalProcessId&&o(),a.isApprovalDialog=!0,y["a"].post("/workflowStart/getStepDetailList",{workflowId:e.workflowId,approvalProcessId:e.approvalProcessId}).then(e=>{a.approvalList=e.list})};return{...Object(l["toRefs"])(a),submitApproval:r,checkApprovalProcess:s,tools:y["a"]}}},f=a("6b0d"),j=a.n(f);const v=j()(O,[["render",m]]);t["a"]=v}}]);